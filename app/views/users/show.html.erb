<<<<<<< HEAD

<br>
<div class="bl-book-page">
	<div align="right">
		
		<% if @user.id == current_user.id %>
			<%# Do nothing since the current user is looking at his own profile %>
		<% else %>
			<% if current_user.following?(@user) %>
				<button><%= link_to "Unfollow", unfollow_user_path(@user) %></button>
			<% else %>
				<button><%= link_to "Follow", follow_user_path(@user) %></button>
			<% end %>
		<% end %>
	
 	</div>
 	<div class="avatar" align="center">
 		<% if @user.id == current_user.id %>
		<a href="<%= edit_user_registration_path %>">
			<%= image_tag @user.avatar.url, :class=>"img-circle", :mouseover =>"assets/edit-pro.png" %>
		</a>
		<% else %>
			<%= image_tag @user.avatar.url, :class=>"img-circle" %>
		<% end %>
 		<%#<%= image_tag avatar_big_url(@user), :class=>"img-circle"  %>
 		
	</div>
	<%# if current user and if not reading any books - Search form to add #%>
	
	<h3 align="center"><%= link_to @user.name, user_path %>  is currently reading: 
			<span class="probook"><%= @book.collect{ |f| link_to(f.title, book_path(:id => f.olidb))}.to_sentence.html_safe %>
			</span>
		  <% if @user.id == current_user.id %>
			     <div id="search-form">
		             <form class="formy" action="/search" method="get" id="search_form">
                       <input class="indx" id="search" type="text" name="q" value>
                       <input class="mag-glass" id="search_btn" type="submit" value="Search">
		       		</form>
                </div>
		   <% else %>
	      <% end %>
		
	</h3>
	<br>
	<hr>

	<h4>Recommended Reading</h4>
	<div class="rec-well">
			
				<% @rec.each do |rec| %> 
				<ul class="inline">
				  <li>
					<a href="<%= book_path(:id => rec.olidb) %>">
					<%= (image_tag ("http://content-3.powells.com/cgi-bin/imageDB.cgi?isbn=#{@reccover.isbn}"), :class=>"book-cover-small")%>
					</a>
					<br>
						<%= link_to rec.title, book_path(:id => rec.olidb) %>
				  </li>
				</ul>
				<% end %>
			
			<hr>	
			<small><i>Favorite Authors </i></small>
			<ul class="inline">
			</ul>
			
	</div>
	<div class="row-fluid marketing" align="center">
	<div class="span6">
     <h4>Past Reads</h4>
     <hr>
       <ul class="unstyled">
          <% @past.each do |past| %>
          <li>
          	<%= link_to past.title, book_path(:id => past.olidb) %>  <%= past.author %>
          </li>
          <% end %>
         <!--  <span class="article-feed">
         <% @pastlink.each do |pastlink| %>
          <li><%= link_to pastlink.title, pastlink.source, target: "_blank"  %> | <%= link_to "Discuss", link_path(:id => pastlink.id)%></li>
         <% end %>
          </span> -->
       </ul>
   </div>
   <div class="span6">
     <h4>Future Reads</h4> 
     <hr>
     <ul class="unstyled">
      <% @future.each do |future| %>
        <li><%= link_to future.title, book_path(:id => future.olidb) %>  <%= future.author %></li>
        <!--<li book-id="<%= future.olidb %>" order="<%= future.order %>"><%= link_to future.title, book_path(:id => future.olidb) %>  <%= future.author %></li> !-->
          <% end %>
        <!--   <span class="article-feed">
          <% @futurelink.each do |futurelink| %>
            <li><%= link_to futurelink.title, link_path(:id => futurelink.id), target: "_blank" %> </li>
          <% end %>
  		  </span> -->
     </ul>
 	</div>

 	<script>
 		$('.sortable').sortable({forcePlaceholderSize: true}).bind('sortupdate', function(e, ui) {
    		var d = [];
    		$('.sortable li').each( function() {
    			var book_id = $(this).attr('book-id');
    			var order = $(this).index() + 1;
    			d.push({'book_id': book_id, 'order': order});
    		});
    		var data = {'data': d}
    		console.log(d);
   			$.post('/books/reorder', data, function(resp) {
   				alert(resp);
   			});
		});
 	</script>
 </div>
     	
     <% if @user.id == current_user.id %>
    <hr>
    <div class="rec-act" align="center">
     
	  <h5>Recent activity:</h5>
	   <% @activities.each do |activity| %>
		<div class="activit">
		
		  <% if activity.owner == current_user %>
			<%= link_to activity.owner.name, activity.owner if activity.owner %>
		  <% else %>
			<%= link_to activity.owner.name, activity.owner if activity.owner %>
		  <% end %>

		 <%= render_activity activity %>
		
		<span class="feed-comment">
			<% Acomment.all.where(:activity_id => activity.id).each do |acomment| %>
				<br>
			   <%= link_to User.find(acomment.user_id).name, user_path(acomment.user_id) %>:
			 <span style="font-size: 12px;"> 
			   <%= acomment.comment %>
			 </span>
		     <% end %>
		 </span>
		 
		<div id="ac-<%= activity.id %>" style="display: none;">
			<%= form_for @acomment, :url => acomments_path, method: :post do |f| %>
				<%= f.hidden_field :activity_id, :value => activity.id %>
				<%= f.hidden_field :user_id, :value => current_user.id %>
				<%= f.text_field :comment %>
				<%= f.submit "Comment", :class => "btn" %>
			<% end %>
		</div>
		
		<script type="text/javascript">
			$(function(){
			  $('#al-<%= activity.id %>').click(function(){
			     $('#ac-<%= activity.id %>').toggle();
			  });
			});
		</script>
			 
		</div>
		<% end %>
		
	</div>
	  <% else %>
	<% end %>
	
</div>

=======
>>>>>>> profile_page
<div id="main">
	<div class="container">
		<div class="row">
			<div class="row">
				<div id="profile-content">
					<div id="profile-card">
						<% if @user.id == current_user.id %>
								<%# Do nothing since the current user is looking at his own profile %>
							<% else %>
								<% if current_user.following?(@user) %>
									<button class="btn btn-default btn-sm pull-right"><%= link_to "Unfollow", unfollow_user_path(@user) %></button>
								<% else %>
									<button class="btn btn-default btn-sm pull-right"><%= link_to "Follow", follow_user_path(@user) %></button>
								<% end %>
							<% end %>
						<% if @user.id == current_user.id %>
						<a href="<%= edit_user_registration_path %>">
							<%= image_tag @user.avatar.url, :class=>"img-circle", :mouseover =>"assets/edit-pro.png" %>
						</a>
						<p id="currently-reading"><strong><%= @user.name %></strong> is currently reading <%= @book.collect{ |f| link_to(f.title, book_path(:id => f.olidb))}.to_sentence.html_safe %></p>
						<% else %>
						<div id="profile-card-img">
							<%= image_tag @user.avatar.url, :class=>"img-circle" %>
						</div>
						<p id="user-name"><%= @user.name %></p>
						<p id="currently-reading">is currently reading <%= @book.collect{ |f| link_to(f.title, book_path(:id => f.olidb))}.to_sentence.html_safe %></p>
						<% end %>
					</div>
					<div id="recommended-reads">
						<p>Recommended Reading</p>
						<div class="row">
							<% @rec.each do |rec| %> 
							<div class="col-md-3">
								<img src="http://placehold.it/180x240">
							</div>
							<% end %>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6">
							<div id="past-reads">
								<p>Past reads</p>
								<ul>
									<% @past.each do |past| %>
		          					<li>
		          						<%= link_to past.title, book_path(:id => past.olidb) %>  <%= past.author %>
		          						<span class="past-read-author">by: <%= past.author %></span>
		          					</li>
		          					<% end %>
								</ul>
							</div>
						</div>
						<div class="col-md-6">
							<div id="future-reads">
								<p>Future reads</p>
								<ul>
									<% @future.each do |future| %>
		        					<li><%= link_to future.title, book_path(:id => future.olidb) %> </li>
		        					<!--<li book-id="<%= future.olidb %>" order="<%= future.order %>"><%= link_to future.title, book_path(:id => future.olidb) %>  <%= future.author %></li> !-->
		        					<span id="past-read-author">by: <%= future.author %></span>
		          					<% end %>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script>
	/*$('.sortable').sortable({forcePlaceholderSize: true}).bind('sortupdate', function(e, ui) {
		var d = [];
		$('.sortable li').each( function() {
			var book_id = $(this).attr('book-id');
			var order = $(this).index() + 1;
			d.push({'book_id': book_id, 'order': order});
		});
		var data = {'data': d}
		console.log(d);
			$.post('/books/reorder', data, function(resp) {
				alert(resp);
			});
	});*/
	// tooltip to change the book status
	<% if @user.id == current_user.id %>
	$('#currently-reading a').popover({
		html: true,
		placement: 'bottom',
		trigger: 'click',
		content: '<button class="btn btn-block btn-sm btn-default">Abandon it</button><button class="btn btn-sm btn-block btn-default">Already read it</button><button class="btn btn-sm btn-block btn-default">Going to read it</button> <a href="#">Go to book page</a>'

		// BOOKSTATUS buttons
		// <%= button_to "Abandon it", {:controller => :books, :action => 'destroy'}, :method => :delete, :type => "button" %>		
			// if you get an error with [] take out the :id seciont - it may not be necessary since we are already only addressing books with this status...
		// 		<%= button_to "Finished!", {:controller => :books, :action => 'update'}, :method => :put, :type => "button" %>
	});
	$('#currently-reading a').click( function(e){
		e.preventDefault();
	});
	<% end %>
</script>
